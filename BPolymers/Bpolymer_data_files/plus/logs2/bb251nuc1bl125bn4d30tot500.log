#atom_style bond #no stiffness
atom_style angle #with stiffness

boundary        p p p
###
# Pair interactions require lists of neighbours to be calculated
###

#neighbor 0.3 bin
neighbor 4 bin

neigh_modify every 1 delay 1 check yes
atom_modify sort 0 0
### Generate RESTART file, SPECIAL format, not a .txt file ###
### Useful if simulation crashes ###

restart 1000000 plusshaped/restarts2/$f.restart
restart 1000000 plusshaped/restarts2/bb251nuc1bl125bn4d30tot500.restart
#############################



### READ "start" data file ###

read_data plusshaped/$f.dat
read_data plusshaped/bb251nuc1bl125bn4d30tot500.dat
Reading data file ...
  orthogonal box = (-1000 -1000 -1000) to (1000 1000 1000)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  501 atoms
  scanning bonds ...
  3 = max bonds/atom
  scanning angles ...
  6 = max angles/atom
  reading bonds ...
  500 bonds
  reading angles ...
  502 angles
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     4 = max # of 1-2 neighbors
     4 = max # of 1-3 neighbors
     8 = max # of 1-4 neighbors
    12 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.037 seconds

######################

### READ "REstart" data file ###

######################



###
# Define groups (atom type 1 is group 'all')
###
group all type 1
501 atoms in group all


###
# Dump configs - "simple dumpings"
###

###
# Dump configs + box coords
###

dump   1   all   custom   1000  plusshaped/trjs2/$f.lammpstrj  id  x y z  ix iy iz
dump   1   all   custom   1000  plusshaped/trjs2/bb251nuc1bl125bn4d30tot500.lammpstrj  id  x y z  ix iy iz
dump_modify   1   format line "%d %.5f %.5f %.5f %d %d %d"

########################################################################


###################################################################
# Stiffness term
#
# E = K * (1+cos(theta)), K>0
#
angle_style   cosine
#change this coefficient to change stiffness (e.g. 1,5,10)
angle_coeff   1 1.0
###################################################################

###################################################################
# Pair interaction between non-bonded atoms
#
#  Lennard-Jones 12-6 potential with cutoff:
#  potential E=4epsilon[ (sigma/r)^12 - (sigma/r)^6]  for r<r_cut
#
#  1.12246 = 2^(1/6) is the minimum of the potential


pair_style      lj/cut 1.12246152962189
#pair_style      lj/cut 3

#
#  pair_modify shift yes adds a constant to the potential such

#  that E(r_cut)=0. Forces remains unchanged.
#

pair_modify     shift yes

#
#  pair_coeff for lj/cut, specify 4:
#    * atom type interacting with
#    * atom type
#    * epsilon (energy units)
#    * sigma (distance units)
#

pair_coeff      1 1 1.0 1.0
###################################################################

###################################################################
# Pair interaction between non-bonded atoms
#
#  soft potential, for PUSHING apart overlapping atoms
#  potential E=A*(1 + cos(pi*r/r_c))
#
#  1.12246 = 2^(1/6) is the cut-off r_c

#pair_style     soft 1.12246152962189

#
#  pair_coeff for soft, specify 3:
#    * atom type interacting with
#    * atom type
#    * A
#
#

#pair_coeff      1 1 100.0
###################################################################

###################################################################
# Pair interaction between bonded atoms
#
# Fene potential + Lennard Jones 12-6:

#
#  E= - 0.5 K R0^2 ln[ 1- (r/R0)^2]
#     + 4epsilon[ (sigma/r)^12 - (sigma/r)^6] + epsilon
#

bond_style   fene


#
# For style fene, specify:
#   * bond type
#   * K (energy/distance^2)
#   * R0 (distance)
#   * epsilon (energy)  (LJ component)
#   * sigma (distance)  (LJ component)
#


special_bonds fene #<=== I M P O R T A N T (new command)
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        1        1       
  special bond factors coul:  0        1        1       
     4 = max # of 1-2 neighbors
    12 = max # of special neighbors
  special bonds CPU = 0.000 seconds

bond_coeff   1   30   2   1.0   1.0


###################################################

###################################################################
# Pair interaction between bonded atoms
#
# Harmonic potential:
#
#  E= K * (R-R0)^2
#

#bond_style   harmonic

#
# For style harmonic, specify:
#   * bond type
#   * K (energy/distance^2)
#   * R0 (distance)
#

#bond_coeff   1   60.0   1.0
#bond_coeff   2   harmonic 0.1   1.0

###################################################
compute 1 all gyration
variable rog equal c_1
#compute 2 all coord/atom cutoff 1.1

#dump 2 all custom 10000 contact_number.dump id c_2


###
# Set up fixes
###
thermo_style   custom   step  temp enthalpy c_1
fix 1 all nve   ###NVE ensemble

fix 2 all   langevin   1.0 1.0 1.0  778655   ###Langevin integrator Tstart Tstop 1/friction rndseed


##### Sample thermodynamic info  (temperature, energy, pressure, etc.) #####
thermo 1000









############################################################################

###
# set timestep of integrator

timestep 0.01

###
# run integration for a number of steps
###
#run 0
#variable r equal c_1
#if "$r < 63.1" then "quit 1"

# lj potential minimum, cause molecule to explore
run 100000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Last active /omp style is angle_style cosine/omp
Neighbor list info ...
  update: every = 1 steps, delay = 1 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.1224615
  ghost atom cutoff = 5.1224615
  binsize = 2.5612308, bins = 781 781 781
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/omp, perpetual
      attributes: half, newton on, omp
      pair build: half/bin/newton/omp
      stencil: half/bin/3d
      bin: standard
WARNING: Communication cutoff 5.12246152962189 is shorter than a bond length based estimate of 5.455. This may lead to errors. (src/comm.cpp:723)
Per MPI rank memory allocation (min/avg/max) = 1861 | 1861 | 1861 Mbytes
   Step          Temp         Enthalpy         c_1      
         0   0              13.166229      65.891059    
      1000   0.97536981     17.667139      64.924594    
      2000   0.9998985      18.47169       63.875263    
      3000   0.96990497     18.921824      62.88386     
      4000   0.96867363     18.576488      61.891886    
      5000   1.0501359      19.024453      60.992647    
      6000   1.0076001      18.979299      60.181416    
      7000   1.0589838      19.51866       59.494044    
      8000   0.97747094     19.703121      59.108532    
      9000   1.0596713      19.43052       58.596605    
     10000   1.0278016      20.092538      58.158868    
     11000   1.043023       19.487022      57.661641    
     12000   0.97142965     19.649671      57.053932    
     13000   0.96085322     19.808513      56.570268    
     14000   0.9876458      19.664165      56.084069    
     15000   1.023782       20.201284      55.842186    
     16000   1.0393245      19.532926      55.286048    
     17000   0.99934004     20.223995      54.915598    
     18000   1.0072121      19.711053      54.853848    
     19000   1.0070795      20.195612      54.262609    
     20000   1.0017612      19.566397      53.900256    
     21000   1.0371356      19.474437      53.481816    
     22000   1.0559743      19.727655      53.181404    
     23000   0.97907536     19.338744      52.87044     
     24000   0.92946943     19.557396      52.548149    
     25000   1.0349099      19.820486      52.296304    
     26000   0.99579638     19.964205      51.957169    
     27000   0.98730136     20.014797      51.605227    
     28000   1.0050154      19.888288      51.587367    
     29000   1.0099455      19.933894      51.051916    
     30000   1.0093737      20.539902      50.59655     
     31000   1.0659421      19.47241       50.393739    
     32000   0.98704738     20.039394      50.635527    
     33000   1.0736991      20.421316      50.59579     
     34000   1.0855128      19.591091      50.92681     
     35000   0.96498566     20.030207      50.721082    
     36000   1.0797619      20.030432      50.573735    
     37000   1.0123047      20.093485      50.546392    
     38000   1.019442       19.997518      50.409937    
     39000   0.99859423     19.611643      50.543172    
     40000   1.0183971      19.086305      50.497681    
     41000   0.94067329     19.576203      50.008355    
     42000   1.0081945      20.301939      49.850326    
     43000   0.96192482     19.996029      49.635201    
     44000   0.96574232     20.329522      49.562465    
     45000   1.0373504      19.98014       49.408279    
     46000   0.94528482     19.674891      49.243501    
     47000   1.0311288      20.780579      49.509531    
     48000   1.0124159      20.115691      49.334764    
     49000   1.0244473      20.171771      48.994792    
     50000   1.0087743      20.126735      48.898265    
     51000   1.0013115      20.287339      48.626189    
     52000   1.047229       20.635008      48.616698    
     53000   0.985923       20.403674      48.196254    
     54000   0.94943801     20.170395      48.335994    
     55000   1.0210735      20.420767      48.240664    
     56000   1.0182161      19.49398       47.898512    
     57000   1.0645055      20.781943      47.65635     
     58000   0.9981662      20.13356       47.957106    
     59000   0.99029839     19.806531      47.668404    
     60000   0.99661815     19.921008      47.087173    
     61000   1.024536       20.709278      46.586605    
     62000   1.0075309      19.617221      46.431988    
     63000   1.0025552      20.780759      46.338102    
     64000   0.96427621     20.237363      46.027381    
     65000   1.0187068      20.183361      45.978106    
     66000   1.0652682      20.268625      46.093478    
     67000   0.94338386     19.444528      46.082497    
     68000   1.0229397      20.533417      45.850179    
     69000   1.0061467      19.784049      46.003151    
     70000   0.97558084     19.634749      46.120961    
     71000   0.97478621     20.370686      45.954153    
     72000   0.94847607     20.000801      45.63408     
     73000   1.0236586      20.044741      45.472156    
     74000   1.0101765      19.848088      45.194637    
     75000   1.0092367      20.71728       44.986378    
     76000   0.99923623     19.639114      44.749741    
     77000   0.96713721     20.643599      44.533923    
     78000   0.99898366     21.123978      44.473386    
     79000   0.98985873     20.208968      44.33943     
     80000   0.99218291     21.012437      43.988188    
     81000   1.0401608      20.47779       43.967744    
     82000   1.0045814      20.467054      43.749498    
     83000   1.0577301      20.442241      43.671961    
     84000   0.97369086     19.962238      43.524953    
     85000   1.0751225      20.218472      43.257255    
     86000   0.94002806     20.085662      43.197549    
     87000   1.0276427      20.567472      43.289244    
     88000   1.0415626      20.294076      43.099486    
     89000   1.0113925      19.894161      42.888004    
     90000   0.97558271     20.125451      43.110094    
     91000   1.0092315      20.781499      43.064082    
     92000   0.97279404     20.434013      43.180211    
     93000   1.0260222      20.715743      43.136637    
     94000   1.002795       19.941277      43.256657    
     95000   1.0783095      20.704213      43.149092    
     96000   0.98999846     20.464243      43.030222    
     97000   0.96922854     20.689982      42.683023    
     98000   1.0242504      20.572761      42.418626    
     99000   0.99904491     20.137917      42.346151    
    100000   1.0045913      20.589657      42.350285    
Loop time of 423.725 on 2 procs for 100000 steps with 501 atoms

Performance: 203905.619 tau/day, 236.002 timesteps/s
101.3% CPU use with 1 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.5854     | 0.5854     | 0.5854     |   0.0 |  0.14
Bond    | 1.1309     | 1.1309     | 1.1309     |   0.0 |  0.27
Neigh   | 419.37     | 419.37     | 419.37     |   0.0 | 98.97
Comm    | 0.022753   | 0.022753   | 0.022753   |   0.0 |  0.01
Output  | 0.16903    | 0.16903    | 0.16903    |   0.0 |  0.04
Modify  | 2.2688     | 2.2688     | 2.2688     |   0.0 |  0.54
Other   |            | 0.1817     |            |       |  0.04

Nlocal:            501 ave         501 max         501 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           3289 ave        3289 max        3289 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3289
Ave neighs/atom = 6.5648703
Ave special neighs/atom = 1.996008
Neighbor list builds = 1077
Dangerous builds = 0

# Replace lj potential, now collapse
pair_style      lj/cut 3

# Cutoff simul when gyration under 5
# Variable created with equal requires v_ + 'name'
fix 3 all halt 1000 v_rog < 7

run 5000000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Last active /omp style is angle_style cosine/omp
Per MPI rank memory allocation (min/avg/max) = 1861 | 1861 | 1861 Mbytes
   Step          Temp         Enthalpy         c_1      
    100000   1.0045913      19.839904      42.350285    
    101000   0.97561475     19.550053      42.159819    
    102000   1.0078713      19.878821      41.809633    
    103000   0.96539853     19.562386      41.5093      
    104000   1.0178226      19.69941       40.980029    
    105000   1.0033943      18.954054      40.492901    
    106000   1.0009925      19.668077      39.755769    
    107000   1.0238588      19.504179      39.396563    
    108000   0.97074537     19.433657      39.497506    
    109000   1.0481848      19.024172      39.450253    
    110000   0.98540861     19.278987      39.298381    
    111000   1.0527402      19.231632      38.999074    
    112000   0.99015422     18.802931      39.001394    
    113000   0.99984066     18.764433      38.693145    
    114000   1.0122719      19.147993      38.591122    
    115000   1.0715999      19.650791      38.201762    
    116000   1.0373586      19.487308      38.009501    
    117000   1.0517747      18.905684      37.639213    
    118000   1.0069835      19.014974      37.688475    
    119000   1.0521351      19.002185      37.541108    
    120000   0.99891606     19.497382      37.002246    
    121000   1.0257495      18.750886      36.427175    
    122000   1.0752365      19.128991      35.872911    
    123000   1.0395435      18.686451      36.028581    
    124000   1.0157657      19.449163      35.734221    
    125000   0.96617201     19.441196      35.391529    
    126000   1.0144472      18.82482       34.855656    
    127000   1.0353647      18.604334      34.440359    
    128000   1.0299349      19.453621      33.91968     
    129000   1.050544       18.88881       33.831199    
    130000   1.0122638      19.092051      33.547143    
    131000   1.0401392      18.926446      33.311494    
    132000   0.98412915     18.640802      32.945895    
    133000   1.0361176      18.848348      32.159746    
    134000   1.0711959      18.954653      31.957287    
    135000   0.96201495     19.029627      31.542495    
    136000   0.994616       19.180858      31.279887    
    137000   1.0131451      19.227735      31.007172    
    138000   1.0856433      18.625233      30.864712    
    139000   1.0197451      19.022985      30.663112    
    140000   1.0409947      18.903344      29.846181    
    141000   1.0442088      19.51079       29.417773    
    142000   1.006146       18.380709      29.38974     
    143000   1.0032964      18.93862       29.184101    
    144000   0.95724175     18.614012      28.859614    
    145000   0.98780763     19.202928      28.592794    
    146000   1.0273043      18.893161      28.495119    
    147000   0.97513559     18.639359      28.426133    
    148000   1.0407687      18.244097      28.169548    
    149000   0.98502221     18.330598      27.923536    
    150000   1.0366093      18.617282      28.01292     
    151000   0.95077981     19.127202      27.577492    
    152000   1.0357403      18.993123      27.313462    
    153000   1.0119614      18.234108      26.994935    
    154000   1.0224926      18.48282       26.781845    
    155000   1.0579777      18.548143      26.54778     
    156000   0.97519294     18.686488      26.380697    
    157000   0.99133184     18.288235      26.185444    
    158000   1.0058035      18.556895      25.710059    
    159000   0.96731188     17.987008      25.308432    
    160000   0.98075514     18.582777      25.367713    
    161000   0.98824727     18.044559      24.97476     
    162000   1.0042878      17.677615      24.711514    
    163000   0.91821808     17.920411      24.545495    
    164000   0.96846328     18.620919      24.290953    
    165000   1.0206938      18.753046      24.236412    
    166000   1.0592347      18.63838       23.591338    
    167000   1.0111457      18.693488      23.413492    
    168000   0.96082332     18.472569      23.099954    
    169000   0.93414227     18.294799      22.77905     
    170000   1.0522562      18.340015      22.8099      
    171000   0.93492269     18.029171      22.817195    
    172000   0.99647428     19.35042       22.813739    
    173000   1.0034431      17.820237      22.403478    
    174000   0.96168053     18.41863       22.243642    
    175000   0.96890196     17.612238      22.13001     
    176000   1.0240475      18.075291      21.726919    
    177000   1.0209535      17.821296      22.006135    
    178000   0.99998155     18.468367      21.773653    
    179000   1.0881809      18.728203      21.7157      
    180000   1.0644912      17.932022      21.362077    
    181000   1.0185452      17.829923      21.14727     
    182000   1.0338401      18.291939      20.933946    
    183000   0.978026       17.952402      20.754191    
    184000   0.98951772     18.730833      20.350791    
    185000   1.0069577      18.223474      19.751317    
    186000   1.092868       18.092808      19.820789    
    187000   1.0551312      18.568671      19.57036     
    188000   1.0141167      18.704043      19.49839     
    189000   1.024011       18.465114      19.289263    
    190000   1.0184247      17.423039      19.017483    
    191000   1.0900562      18.517482      18.929823    
    192000   1.0385869      18.182555      18.685595    
    193000   1.0333628      18.606576      18.303139    
    194000   1.0532856      18.760698      18.179664    
    195000   1.0035788      17.846366      18.079324    
    196000   1.036025       18.556301      17.611813    
    197000   1.0126355      18.06286       17.438183    
    198000   0.95167223     17.769323      17.453367    
    199000   1.0789423      18.199388      16.918086    
    200000   1.0406213      17.947124      16.801122    
    201000   1.0185305      17.511725      16.582586    
    202000   0.98886315     17.635679      16.149732    
    203000   1.0474979      18.561607      15.648697    
    204000   0.99279576     17.741215      15.642726    
    205000   0.96538035     18.563993      15.434919    
    206000   0.99243076     18.313704      15.189377    
    207000   1.0037176      17.708         14.77399     
    208000   0.96988395     17.365353      14.535985    
    209000   0.98782291     18.00033       14.54059     
    210000   1.0255679      17.709729      14.548591    
    211000   0.94188675     17.850102      14.630282    
    212000   1.0462144      18.774062      14.570515    
    213000   0.95222299     17.871997      14.503883    
    214000   1.069481       18.517503      14.059273    
    215000   0.94974257     17.30398       13.944306    
    216000   0.98945937     18.461607      13.836317    
    217000   0.98753671     17.932012      13.428364    
    218000   0.979515       18.438992      13.085578    
    219000   1.0400795      18.059957      12.805969    
    220000   1.0166218      18.372812      12.857357    
    221000   0.98192907     18.673257      12.636116    
    222000   0.95057585     17.262035      12.35521     
    223000   0.93822733     17.248686      11.935755    
    224000   1.0381594      19.072438      11.512719    
    225000   1.0264899      18.879578      11.268657    
    226000   0.97542856     17.509877      10.808389    
    227000   1.0260887      17.253539      10.433829    
    228000   1.009087       18.097402      10.178917    
    229000   1.0047525      17.412762      10.045682    
    230000   1.0163122      17.08626       9.9190033    
    231000   1.0260063      17.349756      9.8374535    
    232000   1.019822       18.356327      9.7500525    
    233000   0.93450215     17.026776      9.6532258    
    234000   1.0130938      16.973127      9.4296409    
    235000   0.96081922     17.13883       9.201058     
    236000   1.0734205      18.03231       9.5388847    
    237000   1.0382782      17.397651      8.9946827    
    238000   1.0084171      17.675516      9.1100366    
    239000   0.99915152     16.88613       8.901503     
    240000   1.0661195      17.569453      9.2616475    
    241000   1.0012211      17.027117      9.2969925    
    242000   0.96602609     17.653387      9.2264404    
    243000   1.0311895      17.300929      9.1030647    
    244000   1.0043535      18.085883      9.0104268    
    245000   0.9416919      17.096948      8.9697767    
    246000   0.9810269      18.167377      9.2542488    
    247000   1.0332557      16.93015       9.0930077    
    248000   0.98340077     17.53005       8.9328302    
    249000   1.0093264      17.115591      8.7675557    
    250000   0.96407712     17.239588      8.4844805    
    251000   0.99016258     17.562617      8.3488345    
    252000   1.0245731      17.302016      8.0486725    
    253000   1.0161454      16.934536      8.2656286    
    254000   1.0007738      16.797957      8.0556899    
    255000   1.0083935      17.428648      7.7650791    
    256000   0.97082488     16.45111       7.4314447    
    257000   1.0216585      17.164146      7.2819715    
    258000   1.03663        18.329413      7.1573013    
Fix halt condition for fix-id 3 met on step 259000 with value 6.941981365248927 (src/fix_halt.cpp:237)
    259000   0.95026171     17.206175      6.9419814    
Loop time of 225.129 on 2 procs for 159000 steps with 501 atoms

Performance: 610211.041 tau/day, 706.263 timesteps/s
109.9% CPU use with 1 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 14.352     | 14.352     | 14.352     |   0.0 |  6.38
Bond    | 1.872      | 1.872      | 1.872      |   0.0 |  0.83
Neigh   | 204.55     | 204.55     | 204.55     |   0.0 | 90.86
Comm    | 0.038011   | 0.038011   | 0.038011   |   0.0 |  0.02
Output  | 0.29324    | 0.29324    | 0.29324    |   0.0 |  0.13
Modify  | 3.7246     | 3.7246     | 3.7246     |   0.0 |  1.65
Other   |            | 0.301      |            |       |  0.13

Nlocal:            501 ave         501 max         501 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          71540 ave       71540 max       71540 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 71540
Ave neighs/atom = 142.79441
Ave special neighs/atom = 1.996008
Neighbor list builds = 1374
Dangerous builds = 0

# This simulation is done
# Move onto the next one
clear
  using 2 OpenMP thread(s) per MPI task
package omp 0
using multi-threaded neighbor list subroutines
next f
jump SELF

###
# Reference paper:
# K. Kremer and G. S. Grest
# Dynamics of entangled linear polymer melts: A molecular-dynamics simulation
# J Chem Phys 92, 5057 (1990)

##################################
# MIHIR: for branched polymers
# LJ minimum first to expand and explore, then collapse
###

###
# Looping through the various plusshaped polymers to simulate,
# define variables to switch through
variable f index bb51nuc1bl25bn4d30tot100 bb101nuc1bl50bn4d30tot200 bb151nuc1bl75bn4d30tot300 bb201nuc1bl100bn4d30tot400 bb251nuc1bl125bn4d30tot500 bb301nuc1bl150bn4d30tot600 bb351nuc1bl175bn4d30tot700 bb401nuc1bl200bn4d30tot800 bb451nuc1bl225bn4d30tot900 bb501nuc1bl250bn4d30tot1000 bb551nuc1bl275bn4d30tot1100 bb601nuc1bl300bn4d30tot1200
###


###
# Box and units  (use LJ units and periodic boundaries)
###

units lj
log plusshaped/logs2/$f.log
log plusshaped/logs2/bb301nuc1bl150bn4d30tot600.log
