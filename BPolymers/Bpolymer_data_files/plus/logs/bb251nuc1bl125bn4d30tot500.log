#atom_style bond #no stiffness
atom_style angle #with stiffness

boundary        p p p
###
# Pair interactions require lists of neighbours to be calculated
###

#neighbor 0.3 bin
neighbor 4 bin

neigh_modify every 1 delay 1 check yes
atom_modify sort 0 0
### Generate RESTART file, SPECIAL format, not a .txt file ###
### Useful if simulation crashes ###

restart 1000000 plusshaped/restarts/$f.restart
restart 1000000 plusshaped/restarts/bb251nuc1bl125bn4d30tot500.restart
#############################



### READ "start" data file ###

read_data plusshaped/$f.dat
read_data plusshaped/bb251nuc1bl125bn4d30tot500.dat
Reading data file ...
  orthogonal box = (-1000 -1000 -1000) to (1000 1000 1000)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  501 atoms
  scanning bonds ...
  3 = max bonds/atom
  scanning angles ...
  6 = max angles/atom
  reading bonds ...
  500 bonds
  reading angles ...
  502 angles
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     4 = max # of 1-2 neighbors
     4 = max # of 1-3 neighbors
     8 = max # of 1-4 neighbors
    12 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.078 seconds

######################

### READ "REstart" data file ###

######################



###
# Define groups (atom type 1 is group 'all')
###
group all type 1
501 atoms in group all


###
# Dump configs - "simple dumpings"
###

###
# Dump configs + box coords
###

dump   1   all   custom   1000  plusshaped/trjs/$f.lammpstrj  id  x y z  ix iy iz
dump   1   all   custom   1000  plusshaped/trjs/bb251nuc1bl125bn4d30tot500.lammpstrj  id  x y z  ix iy iz
dump_modify   1   format line "%d %.5f %.5f %.5f %d %d %d"

########################################################################


###################################################################
# Stiffness term
#
# E = K * (1+cos(theta)), K>0
#
angle_style   cosine
#change this coefficient to change stiffness (e.g. 1,5,10)
angle_coeff   1 1.0
###################################################################

###################################################################
# Pair interaction between non-bonded atoms
#
#  Lennard-Jones 12-6 potential with cutoff:
#  potential E=4epsilon[ (sigma/r)^12 - (sigma/r)^6]  for r<r_cut
#
#  1.12246 = 2^(1/6) is the minimum of the potential


pair_style      lj/cut 1.12246152962189
#pair_style      lj/cut 3

#
#  pair_modify shift yes adds a constant to the potential such

#  that E(r_cut)=0. Forces remains unchanged.
#

pair_modify     shift yes

#
#  pair_coeff for lj/cut, specify 4:
#    * atom type interacting with
#    * atom type
#    * epsilon (energy units)
#    * sigma (distance units)
#

pair_coeff      1 1 1.0 1.0
###################################################################

###################################################################
# Pair interaction between non-bonded atoms
#
#  soft potential, for PUSHING apart overlapping atoms
#  potential E=A*(1 + cos(pi*r/r_c))
#
#  1.12246 = 2^(1/6) is the cut-off r_c

#pair_style     soft 1.12246152962189

#
#  pair_coeff for soft, specify 3:
#    * atom type interacting with
#    * atom type
#    * A
#
#

#pair_coeff      1 1 100.0
###################################################################

###################################################################
# Pair interaction between bonded atoms
#
# Fene potential + Lennard Jones 12-6:

#
#  E= - 0.5 K R0^2 ln[ 1- (r/R0)^2]
#     + 4epsilon[ (sigma/r)^12 - (sigma/r)^6] + epsilon
#

bond_style   fene


#
# For style fene, specify:
#   * bond type
#   * K (energy/distance^2)
#   * R0 (distance)
#   * epsilon (energy)  (LJ component)
#   * sigma (distance)  (LJ component)
#


special_bonds fene #<=== I M P O R T A N T (new command)
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        1        1       
  special bond factors coul:  0        1        1       
     4 = max # of 1-2 neighbors
    12 = max # of special neighbors
  special bonds CPU = 0.000 seconds

bond_coeff   1   30   2   1.0   1.0


###################################################

###################################################################
# Pair interaction between bonded atoms
#
# Harmonic potential:
#
#  E= K * (R-R0)^2
#

#bond_style   harmonic

#
# For style harmonic, specify:
#   * bond type
#   * K (energy/distance^2)
#   * R0 (distance)
#

#bond_coeff   1   60.0   1.0
#bond_coeff   2   harmonic 0.1   1.0

###################################################
compute 1 all gyration
variable rog equal c_1
#compute 2 all coord/atom cutoff 1.1

#dump 2 all custom 10000 contact_number.dump id c_2


###
# Set up fixes
###
thermo_style   custom   step  temp enthalpy c_1
fix 1 all nve   ###NVE ensemble

fix 2 all   langevin   1.0 1.0 1.0  100103   ###Langevin integrator Tstart Tstop 1/friction rndseed


##### Sample thermodynamic info  (temperature, energy, pressure, etc.) #####
thermo 1000









############################################################################

###
# set timestep of integrator

timestep 0.01

###
# run integration for a number of steps
###
#run 0
#variable r equal c_1
#if "$r < 63.1" then "quit 1"

# lj potential minimum, cause molecule to explore
run 100000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 1 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.1224615
  ghost atom cutoff = 5.1224615
  binsize = 2.5612308, bins = 781 781 781
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
WARNING: Communication cutoff 5.12246152962189 is shorter than a bond length based estimate of 5.455. This may lead to errors. (src/comm.cpp:723)
Per MPI rank memory allocation (min/avg/max) = 1861 | 1861 | 1861 Mbytes
   Step          Temp         Enthalpy         c_1      
         0   0              13.166229      65.891059    
      1000   0.98694224     18.67251       64.625634    
      2000   1.0081928      19.073427      63.642117    
      3000   1.0648287      18.69123       62.748032    
      4000   0.94764877     17.904382      61.852739    
      5000   1.0599422      18.729616      60.926932    
      6000   0.98861776     18.933777      60.478235    
      7000   1.0172243      19.249512      59.868746    
      8000   0.97387867     18.357154      59.445993    
      9000   1.002929       19.495001      59.133374    
     10000   0.94756556     19.5485        58.728457    
     11000   1.0034308      18.801883      58.303686    
     12000   1.0209919      19.149356      58.284816    
     13000   0.94529549     19.023275      58.180906    
     14000   1.0005585      19.35826       57.721008    
     15000   0.99997947     19.292559      57.404249    
     16000   0.99960413     19.32381       56.934395    
     17000   0.93574261     19.920355      56.342805    
     18000   0.95446644     19.370289      55.900644    
     19000   0.96649349     19.63683       55.481346    
     20000   0.95418425     20.067586      55.464309    
     21000   1.0244553      20.049027      54.988291    
     22000   1.0079468      20.070745      54.646895    
     23000   0.98551613     19.277877      54.323782    
     24000   1.0009558      20.02456       54.034181    
     25000   0.92330514     18.807638      53.693297    
     26000   0.89608259     19.839025      52.897678    
     27000   0.99756247     20.374673      52.475137    
     28000   0.95304327     20.360325      52.527464    
     29000   0.93859326     19.423289      52.457499    
     30000   1.0257675      19.898493      51.852741    
     31000   1.0209852      19.925676      51.607509    
     32000   0.98389992     19.958465      50.989137    
     33000   1.0504275      20.370592      50.761384    
     34000   1.0189663      20.497608      50.16912     
     35000   1.0079933      20.250294      49.515644    
     36000   1.0559694      20.547493      49.352169    
     37000   0.99250024     20.056409      48.943487    
     38000   1.0166807      20.218899      48.339576    
     39000   0.99262347     20.019771      47.805202    
     40000   0.99624825     20.398323      47.619526    
     41000   0.99749301     19.449113      47.268954    
     42000   0.95243934     20.238785      47.056018    
     43000   0.99417229     20.368206      46.888144    
     44000   1.0859975      20.082094      46.703525    
     45000   1.0220833      20.88864       46.568913    
     46000   1.0523438      20.49071       46.483973    
     47000   0.92292249     20.160341      46.239697    
     48000   0.94599492     20.128748      46.300024    
     49000   1.033618       19.917575      46.376953    
     50000   1.014081       20.560275      46.236438    
     51000   0.95929409     20.791176      45.806147    
     52000   0.98365698     20.514042      45.666575    
     53000   1.0108181      19.878377      45.692088    
     54000   0.97522514     19.810849      45.447411    
     55000   1.0030164      20.981364      45.47961     
     56000   1.0290243      20.552477      45.673121    
     57000   1.0050396      20.888362      45.679267    
     58000   1.0069985      20.52748       45.306189    
     59000   1.0374033      20.221764      45.185647    
     60000   0.96363882     20.79534       44.95472     
     61000   1.0091768      19.891359      44.714892    
     62000   1.0288914      20.7165        44.507001    
     63000   1.0382124      20.864991      44.169575    
     64000   0.99883916     20.095508      44.07801     
     65000   0.98776642     19.688285      43.93541     
     66000   1.0595709      20.287268      43.513561    
     67000   1.0134595      20.35148       43.169401    
     68000   0.92858406     19.967247      43.143904    
     69000   1.0049157      20.520303      42.86796     
     70000   0.97499655     20.558359      42.390086    
     71000   0.9614612      20.646055      42.246542    
     72000   0.93506734     20.084861      42.388673    
     73000   1.0027474      20.460073      42.442979    
     74000   1.0291206      19.954852      42.555185    
     75000   0.95908136     20.05898       42.239367    
     76000   1.080791       20.652712      41.929668    
     77000   1.02317        20.538166      41.92776     
     78000   0.93616745     20.252224      41.480975    
     79000   1.0114081      19.776081      41.233207    
     80000   1.0314942      20.449928      41.118433    
     81000   0.96675033     20.476165      41.251048    
     82000   1.0488226      20.097539      41.115364    
     83000   1.0175242      20.229605      40.860197    
     84000   1.0556843      19.957243      40.703796    
     85000   1.0468872      20.691831      40.736281    
     86000   0.99715045     20.829986      40.452138    
     87000   0.98766742     20.284613      40.621098    
     88000   1.0152151      20.546626      40.171992    
     89000   0.97098661     20.586128      39.86994     
     90000   1.0534058      20.347485      39.580429    
     91000   0.98784529     20.050455      39.766883    
     92000   0.9889527      20.827402      39.623492    
     93000   0.96412094     20.527471      39.667977    
     94000   0.9946187      20.506796      39.914671    
     95000   1.0269151      20.52469       39.454591    
     96000   1.0006159      20.23359       39.278303    
     97000   0.90148935     20.026654      39.601254    
     98000   1.0293623      19.798362      39.230329    
     99000   0.99587968     20.107541      39.171125    
    100000   0.98833289     20.584216      39.196133    
Loop time of 566.795 on 1 procs for 100000 steps with 501 atoms

Performance: 152436.090 tau/day, 176.431 timesteps/s
100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.4672     | 1.4672     | 1.4672     |   0.0 |  0.26
Bond    | 2.9976     | 2.9976     | 2.9976     |   0.0 |  0.53
Neigh   | 558.3      | 558.3      | 558.3      |   0.0 | 98.50
Comm    | 0.03953    | 0.03953    | 0.03953    |   0.0 |  0.01
Output  | 0.24751    | 0.24751    | 0.24751    |   0.0 |  0.04
Modify  | 3.452      | 3.452      | 3.452      |   0.0 |  0.61
Other   |            | 0.2871     |            |       |  0.05

Nlocal:            501 ave         501 max         501 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           3577 ave        3577 max        3577 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3577
Ave neighs/atom = 7.1397206
Ave special neighs/atom = 1.996008
Neighbor list builds = 1083
Dangerous builds = 0

# Replace lj potential, now collapse
pair_style      lj/cut 3

# Cutoff simul when gyration under 5
# Variable created with equal requires v_ + 'name'
fix 3 all halt 1000 v_rog < 5

run 5000000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 1861 | 1861 | 1861 Mbytes
   Step          Temp         Enthalpy         c_1      
    100000   0.98833289     19.801139      39.196133    
    101000   1.0735733      20.011592      39.209081    
    102000   1.0621042      19.633719      38.89916     
    103000   0.984295       19.199961      38.686868    
    104000   0.95612986     19.422456      38.311671    
    105000   0.95036636     19.51253       37.962493    
    106000   0.99372303     19.028889      37.846777    
    107000   0.99702385     19.103089      37.991444    
    108000   0.99011158     18.502519      37.447065    
    109000   0.95878371     18.597779      37.374674    
    110000   0.99578802     19.430975      37.034636    
    111000   1.0534729      18.882478      36.723769    
    112000   1.0175319      18.967226      36.527938    
    113000   0.97508783     19.039342      36.202655    
    114000   0.98339745     18.612853      36.231544    
    115000   1.0093912      19.075922      35.613285    
    116000   1.0165232      17.831341      35.739764    
    117000   1.0241231      19.026935      35.041747    
    118000   0.96416971     19.279068      34.498972    
    119000   1.0056049      18.913571      34.175001    
    120000   0.99420415     19.060425      33.873439    
    121000   1.0301159      19.394318      33.530762    
    122000   1.0265972      18.934604      33.030858    
    123000   0.91275619     18.856571      32.779096    
    124000   1.0116352      19.701277      32.602927    
    125000   0.9399818      19.206123      32.382617    
    126000   0.97615802     18.975331      32.320866    
    127000   1.0121997      18.457985      32.05123     
    128000   1.0476172      18.571411      31.659018    
    129000   1.0175636      19.124116      31.020858    
    130000   0.90932719     18.278642      30.718284    
    131000   1.0676304      19.072816      30.036852    
    132000   0.93803606     18.762425      29.719155    
    133000   1.0213224      18.581426      29.248131    
    134000   0.96311098     18.782963      28.933381    
    135000   0.98386531     18.727611      28.747203    
    136000   1.0311916      18.861039      28.489605    
    137000   0.9488038      18.341167      27.943189    
    138000   0.9912175      18.001453      27.717964    
    139000   0.97964553     18.879639      27.519313    
    140000   0.98504791     19.252632      27.222658    
    141000   1.0222607      17.986963      27.243188    
    142000   0.95894056     18.3201        26.985382    
    143000   1.0080629      18.528889      27.351343    
    144000   0.99129257     18.58514       27.152606    
    145000   1.0293898      18.424278      26.933038    
    146000   0.94781306     17.974044      26.796071    
    147000   1.0311376      17.614914      26.453062    
    148000   0.98272599     18.143444      25.967379    
    149000   1.0368444      18.648305      25.760481    
    150000   1.0140776      18.788427      26.129023    
    151000   1.0032087      18.084137      25.910511    
    152000   0.93231044     17.857768      25.698215    
    153000   1.0228852      18.399372      25.703922    
    154000   1.0064428      18.748911      25.387455    
    155000   0.9941338      18.505466      24.960217    
    156000   0.98085331     18.079454      24.730187    
    157000   1.0171883      17.771106      24.485576    
    158000   1.0132291      19.194611      24.406129    
    159000   0.93785776     18.629155      24.141234    
    160000   1.0334466      19.302531      23.536559    
    161000   1.0829382      18.839804      23.131152    
    162000   0.96404626     18.766103      22.713441    
    163000   0.99695089     18.296036      22.349294    
    164000   0.94414207     18.066266      21.887396    
    165000   0.9928479      17.930132      21.894556    
    166000   1.057393       17.852681      21.635751    
    167000   0.97260602     17.738103      21.439222    
    168000   1.0187081      18.940115      21.480721    
    169000   1.0264774      17.721659      21.285919    
    170000   0.98235272     17.923846      20.715908    
    171000   1.0093939      19.156764      20.279176    
    172000   1.0166481      18.649843      20.203284    
    173000   1.015106       18.570584      20.073075    
    174000   0.99714905     17.05782       19.706715    
    175000   0.96341682     17.783811      19.473176    
    176000   1.0092878      18.448152      19.031655    
    177000   0.96187322     18.255422      18.809862    
    178000   0.97977056     18.147821      18.191171    
    179000   1.0036775      18.267978      17.741029    
    180000   0.96832854     17.774437      17.565922    
    181000   1.0364958      17.943043      17.684729    
    182000   1.0139086      18.472674      17.699395    
    183000   0.99169025     18.46926       17.267588    
    184000   0.95508997     18.251911      17.023092    
    185000   1.0501669      18.34922       16.606986    
    186000   0.95232585     17.788777      16.539801    
    187000   1.0250597      17.619179      16.355165    
    188000   0.97591603     17.898567      16.172912    
    189000   0.98655325     17.93154       15.905622    
    190000   0.96100312     17.241912      15.788543    
    191000   1.0028633      18.106771      15.47801     
    192000   1.1072905      17.579953      15.220361    
    193000   0.94511737     18.502139      15.304645    
    194000   0.96886059     17.205638      14.985437    
    195000   0.99845901     18.326809      14.986532    
    196000   1.0321083      17.84879       14.683235    
    197000   1.0707154      18.082996      14.778002    
    198000   0.97767032     18.349622      14.450059    
    199000   0.99815805     18.705833      14.620585    
    200000   0.95102224     18.346375      14.427477    
    201000   1.0216877      17.814562      14.205421    
    202000   0.99314781     18.270274      14.165781    
    203000   1.0068173      18.791777      13.771148    
    204000   1.0194663      18.157551      13.310069    
    205000   1.0582931      17.924661      13.168394    
    206000   0.99391544     18.2709        12.644017    
    207000   0.98707876     17.274441      12.371134    
    208000   1.0172188      18.318911      11.938051    
    209000   0.99573022     17.009726      11.717387    
    210000   1.0308273      16.696508      11.505955    
    211000   0.99064491     18.354504      11.289911    
    212000   0.9886892      17.652312      11.072691    
    213000   0.9778615      16.872508      10.974685    
    214000   0.96116355     17.744021      10.76845     
    215000   1.0355454      17.86884       10.542619    
    216000   0.96239252     18.270579      9.9623143    
    217000   1.0067781      17.4847        10.158768    
    218000   1.030308       18.131709      9.8373717    
    219000   1.0031472      17.386235      9.9019722    
    220000   1.032939       17.980076      9.3757502    
    221000   1.0260127      17.614066      8.9804926    
    222000   0.95375469     18.185647      9.1313953    
    223000   0.96233512     17.086232      8.7271022    
    224000   1.0189465      17.25626       8.3822142    
    225000   1.0164636      18.092128      8.1782497    
    226000   1.0461086      17.616765      8.307435     
    227000   1.0731008      16.858398      7.799735     
    228000   1.0096179      17.712938      7.7445528    
    229000   1.0689003      18.101794      7.2500549    
    230000   1.0492772      16.805042      7.0319036    
    231000   1.0176692      18.095894      6.7076534    
    232000   1.0230585      17.412171      6.4347364    
    233000   1.0127914      17.995788      6.2523791    
    234000   1.0614862      16.777026      6.1908262    
    235000   0.96556735     17.017642      5.9894965    
    236000   1.0416317      17.4465        5.911306     
    237000   1.0626703      17.411084      6.0422512    
    238000   0.98289822     17.33724       6.1059041    
    239000   1.0709459      17.077149      6.1391087    
    240000   1.0178325      17.366824      6.2738908    
    241000   1.0553996      17.155767      5.9433171    
    242000   1.0307674      16.747603      6.0846641    
    243000   1.0082263      16.787999      6.1788231    
    244000   1.0851009      18.651525      6.3361284    
    245000   1.0875981      16.39232       6.3832609    
    246000   0.96273846     17.762258      6.4556585    
    247000   0.96222535     16.719733      6.3478063    
    248000   1.0295227      17.749907      6.6476144    
    249000   1.015          16.965956      6.3870584    
    250000   0.94510884     17.294287      6.2746025    
    251000   0.95087407     16.71571       6.3017094    
    252000   0.98407825     18.224769      6.0697597    
    253000   0.98107151     16.581795      5.9702593    
    254000   0.97143851     16.169809      5.8865835    
    255000   0.96089039     17.359794      5.7661355    
    256000   0.94709253     17.04774       5.4112248    
    257000   1.0286021      17.787739      5.0458784    
Fix halt condition for fix-id 3 met on step 258000 with value 4.5615569854233895 (src/fix_halt.cpp:237)
    258000   0.98442969     16.710184      4.561557     
Loop time of 726.123 on 1 procs for 158000 steps with 501 atoms

Performance: 188001.225 tau/day, 217.594 timesteps/s
99.9% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 472.88     | 472.88     | 472.88     |   0.0 | 65.12
Bond    | 4.9298     | 4.9298     | 4.9298     |   0.0 |  0.68
Neigh   | 241.62     | 241.62     | 241.62     |   0.0 | 33.28
Comm    | 0.084363   | 0.084363   | 0.084363   |   0.0 |  0.01
Output  | 0.35382    | 0.35382    | 0.35382    |   0.0 |  0.05
Modify  | 5.6616     | 5.6616     | 5.6616     |   0.0 |  0.78
Other   |            | 0.5894     |            |       |  0.08

Nlocal:            501 ave         501 max         501 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          86121 ave       86121 max       86121 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 86121
Ave neighs/atom = 171.8982
Ave special neighs/atom = 1.996008
Neighbor list builds = 1325
Dangerous builds = 0

# This simulation is done
# Move onto the next one
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
next f
jump SELF

###
# Reference paper:
# K. Kremer and G. S. Grest
# Dynamics of entangled linear polymer melts: A molecular-dynamics simulation
# J Chem Phys 92, 5057 (1990)

##################################
# MIHIR: for branched polymers
# LJ minimum first to expand and explore, then collapse
###

###
# Looping through the various plusshaped polymers to simulate,
# define variables to switch through
variable f index bb51nuc1bl25bn4d30tot100 bb101nuc1bl50bn4d30tot200 bb151nuc1bl75bn4d30tot300 bb201nuc1bl100bn4d30tot400 bb251nuc1bl125bn4d30tot500 bb301nuc1bl150bn4d30tot600 bb351nuc1bl175bn4d30tot700 bb401nuc1bl200bn4d30tot800 bb451nuc1bl225bn4d30tot900 bb501nuc1bl250bn4d30tot1000 bb551nuc1bl275bn4d30tot1100 bb601nuc1bl300bn4d30tot1200
###


###
# Box and units  (use LJ units and periodic boundaries)
###

units lj
log plusshaped/logs/$f.log
log plusshaped/logs/bb301nuc1bl150bn4d30tot600.log
